(()=>{var t,e,o,n,r={69314:()=>{},18983:()=>{},48875:(t,e,o)=>{"use strict";var n=o(52107),r=o(95292),a=o(60576),l=o(38090),i=o(13249),s=o(6222);var u=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function c(t,e){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(!((n=t[o])===(r=e[o])||u(n)&&u(r)))return!1;var n,r;return!0}var d=o(64021),f=o(51330),p=o(57928);const g=new Uint8Array(32),m=(0,d.d)("modl");function h(t,e,o){return t.registry.createType("AccountId32",(0,f.e)(m,t.consts.nominationPools.palletId.toU8a(),new Uint8Array([o]),(0,p.a)(e,{bitLength:32}),g)).toString()}const v=function(t,e){void 0===e&&(e=c);var o=null;function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(o&&o.lastThis===this&&e(n,o.lastArgs))return o.lastResult;var a=t.apply(this,n);return o={lastResult:a,lastArgs:n,lastThis:this},a}return n.clear=function(){o=null},n}((function(t,e){return{rewardId:h(t,e,1),stashId:h(t,e,0)}}));onmessage=t=>{const{address:e,endpoint:o}=t.data;(async function(t,e){var o;const u=await async function(t){if(t.startsWith("wss")){const e=new a.U(t);return await l.G.create({provider:e})}return await async function(t){const e=t=>{switch(t){case"Polkadot":return i.WellKnownChain.polkadot;case"Kusama":return i.WellKnownChain.ksmcc3;case"Westend":return i.WellKnownChain.westend2;default:return""}};try{if(console.log("connecting through light client"),e(t).length){const o=new s.x(i,e(t));return await o.connect(),await l.G.create({provider:o})}return Promise.reject(Error)}catch(t){return console.error(t),console.log("faillll"),Promise.reject(t)}}(t)}(e),c=await u.query.nominationPools.lastPoolId();if(console.log(`getMyPools: Getting ${c.toNumber()} pools information.`),!c)return null;const d=[];for(let t=1;t<=c.toNumber();t++)d.push(Promise.all([u.query.nominationPools.metadata(t),u.query.nominationPools.bondedPools(t),u.query.nominationPools.rewardPools(t)]));const f=(null==(o=(await Promise.all(d)).map(((t,e)=>{if(t[1].isSome){var o,n,r,a,l;const i=t[1].unwrap();return{bondedPool:{memberCounter:String(i.memberCounter),points:String(i.points),roles:i.roles,state:i.state},metadata:null!=(o=t[0])&&o.length?null!=(n=t[0])&&n.isUtf8?null==(r=t[0])?void 0:r.toUtf8():null==(a=t[0])?void 0:a.toString():null,poolId:e+1,rewardPool:null!=(l=t[2])&&l.isSome?t[2].unwrap():null}}})))?void 0:o.filter((t=>void 0!==t))).filter((e=>{var o,n,r;return String(null==e||null==(o=e.bondedPool)?void 0:o.roles.root)===t||String(null==e||null==(n=e.bondedPool)?void 0:n.roles.stateToggler)===t||String(null==e||null==(r=e.bondedPool)?void 0:r.roles.nominator)===t})),p=u.registry.chainTokens[0],g=u.registry.chainDecimals[0],m=f.map((async t=>{var e;const o=v(u,t.poolId);if(!o)return console.log(`can not find a pool with id:${t.poolId}`),null;const[a,l,i]=await Promise.all([u.query.nominationPools.rewardPools(t.poolId),u.query.system.account(o.rewardId),u.derive.staking.account(o.stashId)]),s=a.isSome?a.unwrap():null,c=(0,n.x)(r.nw,l.data.free.sub(u.consts.balances.existentialDeposit)),d={};return s&&(d.balance=null!=s&&s.balance?String(s.balance):void 0,d.points=null!=s&&s.points?String(s.points):void 0,d.totalEarnings=null!=s&&s.totalEarnings?String(s.totalEarnings):void 0),{accounts:o,bondedPool:t.bondedPool,decimal:g,member:void 0,metadata:null!=(e=t.metadata)&&e.length?t.metadata.isUtf8?t.metadata.toUtf8():t.metadata.toString():null,myClaimable:Number("0"),poolId:t.poolId,rewardClaimable:Number(c),rewardIdBalance:l.data,rewardPool:s,stashIdAccount:i,token:p}})),h=await Promise.all(m);return JSON.stringify(h)})(e,o).then((t=>{postMessage(t)}))}}},a={};function l(t){var e=a[t];if(void 0!==e)return e.exports;var o=a[t]={id:t,loaded:!1,exports:{}};return r[t].call(o.exports,o,o.exports,l),o.loaded=!0,o.exports}l.m=r,l.x=()=>{var t=l.O(void 0,[33],(()=>l(48875)));return l.O(t)},t=[],l.O=(e,o,n,r)=>{if(!o){var a=1/0;for(c=0;c<t.length;c++){for(var[o,n,r]=t[c],i=!0,s=0;s<o.length;s++)(!1&r||a>=r)&&Object.keys(l.O).every((t=>l.O[t](o[s])))?o.splice(s--,1):(i=!1,r<a&&(a=r));if(i){t.splice(c--,1);var u=n();void 0!==u&&(e=u)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,n,r]},o=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var r=Object.create(null);l.r(r);var a={};e=e||[null,o({}),o([]),o(o)];for(var i=2&n&&t;"object"==typeof i&&!~e.indexOf(i);i=o(i))Object.getOwnPropertyNames(i).forEach((e=>a[e]=()=>t[e]));return a.default=()=>t,l.d(r,a),r},l.d=(t,e)=>{for(var o in e)l.o(e,o)&&!l.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},l.f={},l.e=t=>Promise.all(Object.keys(l.f).reduce(((e,o)=>(l.f[o](t,e),e)),[])),l.u=t=>t+".js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;l.g.importScripts&&(t=l.g.location+"");var e=l.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=t})(),(()=>{var t={666:1};l.f.i=(e,o)=>{t[e]||importScripts(l.p+l.u(e))};var e=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension||[],o=e.push.bind(e);e.push=e=>{var[n,r,a]=e;for(var i in r)l.o(r,i)&&(l.m[i]=r[i]);for(a&&a(l);n.length;)t[n.pop()]=1;o(e)}})(),n=l.x,l.x=()=>l.e(33).then(n),l.x()})();